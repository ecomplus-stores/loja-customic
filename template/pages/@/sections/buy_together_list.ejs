<%
const buyList = opt.buy_list

if (Array.isArray(buyList) && buyList.length && _.state.categories && _.state.categories.length) {
    const filteredCategory = buyList.filter(category => {
        return _.state.categories.some(faq => category.slug === faq.slug)
    });

    let finalArray = []
    filteredCategory.forEach(item => {
        if (item.products && item.products.length) {
            finalArray = finalArray.concat(item.products)
        }
    })
    if (filteredCategory && finalArray && finalArray.length) {
    %>
        <script>
            window.idsBuyTogether = <%- JSON.stringify(finalArray) %>
            window.arrayBuyTogether = <%- JSON.stringify(buyList) %>
        </script>
    <%    }
} else if (Array.isArray(buyList) && buyList.length && _.state && _.state.meta_title) { %>
    <script>
            window.arrayBuyTogether = <%- JSON.stringify(buyList) %>
    </script>
<% } %>